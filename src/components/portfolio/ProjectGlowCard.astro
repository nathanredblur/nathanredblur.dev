---
import { Icon } from "astro-icon/components";
import type { PersonalProject } from "@/data/personal-projects";

interface Props {
	project: PersonalProject;
}

const { project } = Astro.props;

const identifier = `project-${project.title.replace(/\s+/g, "-").toLowerCase()}`;
---

<div class={`glow-container-${identifier} glow-container`}>
	<article
		class={`glow-card glow-card-${identifier} h-fit border border-[#2a2e5a] transition-all duration-300 relative bg-[#101123] text-gray-200 rounded-xl hover:border-transparent w-full`}
	>
		<div class="glows"></div>
		<div class="flex flex-col sm:flex-row relative overflow-hidden">
			<!-- Screenshot area (left) -->
			<div class="sm:w-56 md:w-64 shrink-0 bg-[#0a0b1a] flex items-center justify-center p-6 border-b sm:border-b-0 sm:border-r border-[#2a2e5a]">
				{project.screenshot ? (
					<img
						src={project.screenshot}
						alt={`${project.title} screenshot`}
						class="w-full h-auto rounded-lg object-cover"
					/>
				) : (
					<div class="flex flex-col items-center gap-3 text-gray-600">
						<Icon name="fa6-solid:image" class="text-4xl opacity-40" />
						<span class="text-xs opacity-40">Screenshot coming soon</span>
					</div>
				)}
			</div>

			<!-- Content area (right) -->
			<div class="flex flex-col flex-1 p-5 gap-3">
				<!-- Header: title + status badge -->
				<div class="flex items-start justify-between gap-3">
					<h3 class="text-lg sm:text-xl font-bold text-white m-0">
						{project.title}
					</h3>
					{project.status && (
						<span class="shrink-0 text-[0.65rem] font-medium px-2 py-0.5 rounded-full bg-violet-500/20 text-violet-300 border border-violet-500/30 whitespace-nowrap">
							{project.status}
						</span>
					)}
				</div>

				<!-- Description -->
				<p class="text-sm text-gray-400 leading-relaxed m-0">
					{project.description}
				</p>

				<!-- Tools -->
				<div class="flex flex-wrap gap-1.5 mt-1">
					{project.tools.map((tool) => (
						<span class="text-[0.65rem] font-medium px-2 py-0.5 rounded bg-[#1a1443] text-violet-300">
							{tool}
						</span>
					))}
				</div>

				<!-- Links -->
				<div class="flex items-center gap-3 mt-auto pt-2">
					<a
						href={project.github}
						target="_blank"
						rel="noopener noreferrer"
						class="flex items-center gap-1.5 text-sm text-gray-400 hover:text-violet-400 transition-colors duration-200"
					>
						<Icon name="fa6-brands:github" class="text-base" />
						<span>Source</span>
					</a>
					{project.website && (
						<a
							href={project.website}
							target="_blank"
							rel="noopener noreferrer"
							class="flex items-center gap-1.5 text-sm text-gray-400 hover:text-violet-400 transition-colors duration-200"
						>
							<Icon name="fa6-solid:arrow-up-right-from-square" class="text-xs" />
							<span>Live</span>
						</a>
					)}
				</div>
			</div>
		</div>
	</article>
</div>

<style>
	.glow-container {
		--spread: 60;
	}

	.glow-card {
		--active: 0.15;
		--start: 0;
	}

	.glow-card:is(:hover, :focus-visible) {
		z-index: 2;
	}

	.glows {
		pointer-events: none;
		position: absolute;
		inset: 0;
		filter: blur(calc(var(--blur) * 1px));
	}

	.glows::after,
	.glows::before {
		--alpha: 0;
		content: "";
		background: conic-gradient(
			from 180deg at 50% 70%,
			#f626af 0deg,
			#8228ec 72.0000010728836deg,
			#f626af 144.0000021457672deg,
			#0025ba 216.00000858306885deg,
			#f626af 288.0000042915344deg,
			#fafafa 1turn
		);
		background-attachment: fixed;
		position: absolute;
		inset: -5px;
		border: 8px solid transparent;
		border-radius: 12px;
		mask:
			linear-gradient(#0000, #0000),
			conic-gradient(
				from calc((var(--start) - (var(--spread) * 0.5)) * 1deg),
				#000 0deg,
				#fff,
				#0000 calc(var(--spread) * 1deg)
			);
		mask-composite: intersect;
		mask-clip: padding-box, border-box;
		opacity: var(--active);
		transition: opacity 1s;
	}

	.glow-card::before {
		position: absolute;
		inset: 0;
		border: 2px solid transparent;
		content: "";
		border-radius: 12px;
		pointer-events: none;
		background: #84738c;
		background-attachment: fixed;
		mask:
			linear-gradient(#0000, #0000),
			conic-gradient(
				from calc(((var(--start) + (var(--spread) * 0.25)) - (var(--spread) * 1.5)) * 1deg),
				#ffffff26 0deg,
				white,
				#ffffff26 calc(var(--spread) * 2.5deg)
			);
		mask-clip: padding-box, border-box;
		mask-composite: intersect;
		opacity: var(--active);
		transition: opacity 1s;
	}

	.glow-card::after {
		--bg-size: 100%;
		content: "";
		pointer-events: none;
		position: absolute;
		background: conic-gradient(
			from 180deg at 50% 70%,
			#f626af 0deg,
			#8228ec 72.0000010728836deg,
			#f626af 144.0000021457672deg,
			#0025ba 216.00000858306885deg,
			#f626af 288.0000042915344deg,
			#fafafa 1turn
		);
		background-attachment: fixed;
		border-radius: 12px;
		opacity: var(--active, 0);
		transition: opacity 1s;
		--alpha: 0;
		inset: 0;
		border: 2px solid transparent;
		mask:
			linear-gradient(#0000, #0000),
			conic-gradient(
				from calc(((var(--start) + (var(--spread) * 0.25)) - (var(--spread) * 0.5)) * 1deg),
				#0000 0deg,
				#fff,
				#0000 calc(var(--spread) * 0.5deg)
			);
		filter: brightness(1.5);
		mask-clip: padding-box, border-box;
		mask-composite: intersect;
	}
</style>
